# Start ssh-agent if not already running
if ! pgrep -u "$USER" ssh-agent > /dev/null; then
    eval "$(ssh-agent -s)"
fi

# Automatically add dep* keys from ~/.ssh/
for KEY in "$HOME/.ssh"/dep*"; do
    [[ "$KEY" == *.pub || ! -f "$KEY" ]] && continue
    FINGERPRINT=$(ssh-keygen -lf "$KEY" | awk '{print $2}')
    if ! ssh-add -l 2>/dev/null | grep -q "$FINGERPRINT"; then
        ssh-add "$KEY" >/dev/null 2>&1 && echo "Added SSH key: $KEY"
    fi
done
